{"cells":[{"cell_type":"markdown","metadata":{"id":"f0yXF85Seehn"},"source":["### 데이터 전처리\n"]},{"cell_type":"code","execution_count":1,"metadata":{"id":"DIPUOtejEq1l","executionInfo":{"status":"ok","timestamp":1677913813259,"user_tz":-540,"elapsed":4359,"user":{"displayName":"JYUN im","userId":"16123544492363400793"}}},"outputs":[],"source":["# 라이브러리 불러오기\n","import numpy as np\n","import pandas as pd\n","import tensorflow as tf\n","import json\n","import warnings\n","warnings.filterwarnings('ignore')"]},{"cell_type":"code","execution_count":2,"metadata":{"id":"nj28KTpSYLXx","executionInfo":{"status":"ok","timestamp":1677913837486,"user_tz":-540,"elapsed":17279,"user":{"displayName":"JYUN im","userId":"16123544492363400793"}}},"outputs":[],"source":["# 데이터 불러오기\n","train_url = '/content/drive/MyDrive/추천 시스템/train.json'\n","val_url = '/content/drive/MyDrive/추천 시스템/val.json'\n","test_url = '/content/drive/MyDrive/추천 시스템/test.json'\n","song_meta_url = '/content/drive/MyDrive/추천 시스템/song_meta.json'\n","\n","with open(train_url, 'r') as f:\n","  train = json.load(f)\n","with open(test_url, 'r') as f:\n","  test = json.load(f)\n","with open(val_url, 'r') as f:\n","  val = json.load(f)\n","with open(song_meta_url, 'r') as f:\n","  song_meta = json.load(f)\n","\n","train = pd.DataFrame(train)\n","val = pd.DataFrame(val)\n","test = pd.DataFrame(test)\n","song_meta = pd.DataFrame(song_meta)\n","\n","# 묶여있는 노래 value를 각각의 value로 나눔\n","def song_div(df):\n","  data = df.copy()\n","  data_list = data['songs'].apply(lambda x : pd.Series(x)).stack().reset_index(1, name='song').drop('level_1', axis=1)\n","  return data_list\n","\n","# 묶여있는 태그 value를 각각의 value로 나눔\n","def tag_div(df):\n","  data = df.copy()\n","  data_list = data['tags'].apply(lambda x : pd.Series(x)).stack().reset_index(1, name='tag').drop('level_1', axis=1)\n","  return data_list"]},{"cell_type":"code","execution_count":3,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":337},"executionInfo":{"elapsed":374,"status":"ok","timestamp":1677913843474,"user":{"displayName":"JYUN im","userId":"16123544492363400793"},"user_tz":-540},"id":"Lbtlm9byZ6mR","outputId":"83de5dc3-922d-4921-9d50-b7816b158557"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["                                                tags      id  \\\n","0                                                [락]   61281   \n","1                                           [추억, 회상]   10532   \n","2                                          [까페, 잔잔한]   76951   \n","3  [연말, 눈오는날, 캐럴, 분위기, 따듯한, 크리스마스캐럴, 겨울노래, 크리스마스,...  147456   \n","4                                               [댄스]   27616   \n","\n","            plylst_title                                              songs  \\\n","0                여행같은 음악  [525514, 129701, 383374, 562083, 297861, 13954...   \n","1                요즘 너 말야  [432406, 675945, 497066, 120377, 389529, 24427...   \n","2  편하게, 잔잔하게 들을 수 있는 곡.-  [83116, 276692, 166267, 186301, 354465, 256598...   \n","3  크리스마스 분위기에 흠뻑 취하고 싶을때  [394031, 195524, 540149, 287984, 440773, 10033...   \n","4               추억의 노래 ㅋ  [159327, 553610, 5130, 645103, 294435, 100657,...   \n","\n","   like_cnt                updt_date  is_train  \n","0        71  2013-12-19 18:36:19.000         0  \n","1         1  2014-12-02 16:19:42.000         0  \n","2        17  2017-08-28 07:09:34.000         0  \n","3        33  2019-12-05 15:15:18.000         0  \n","4         9  2011-10-25 13:54:56.000         0  "],"text/html":["\n","  <div id=\"df-9335040c-2eec-4bbf-84da-8b5f71702cfd\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>tags</th>\n","      <th>id</th>\n","      <th>plylst_title</th>\n","      <th>songs</th>\n","      <th>like_cnt</th>\n","      <th>updt_date</th>\n","      <th>is_train</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>[락]</td>\n","      <td>61281</td>\n","      <td>여행같은 음악</td>\n","      <td>[525514, 129701, 383374, 562083, 297861, 13954...</td>\n","      <td>71</td>\n","      <td>2013-12-19 18:36:19.000</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>[추억, 회상]</td>\n","      <td>10532</td>\n","      <td>요즘 너 말야</td>\n","      <td>[432406, 675945, 497066, 120377, 389529, 24427...</td>\n","      <td>1</td>\n","      <td>2014-12-02 16:19:42.000</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>[까페, 잔잔한]</td>\n","      <td>76951</td>\n","      <td>편하게, 잔잔하게 들을 수 있는 곡.-</td>\n","      <td>[83116, 276692, 166267, 186301, 354465, 256598...</td>\n","      <td>17</td>\n","      <td>2017-08-28 07:09:34.000</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>[연말, 눈오는날, 캐럴, 분위기, 따듯한, 크리스마스캐럴, 겨울노래, 크리스마스,...</td>\n","      <td>147456</td>\n","      <td>크리스마스 분위기에 흠뻑 취하고 싶을때</td>\n","      <td>[394031, 195524, 540149, 287984, 440773, 10033...</td>\n","      <td>33</td>\n","      <td>2019-12-05 15:15:18.000</td>\n","      <td>0</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>[댄스]</td>\n","      <td>27616</td>\n","      <td>추억의 노래 ㅋ</td>\n","      <td>[159327, 553610, 5130, 645103, 294435, 100657,...</td>\n","      <td>9</td>\n","      <td>2011-10-25 13:54:56.000</td>\n","      <td>0</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-9335040c-2eec-4bbf-84da-8b5f71702cfd')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-9335040c-2eec-4bbf-84da-8b5f71702cfd button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-9335040c-2eec-4bbf-84da-8b5f71702cfd');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":3}],"source":["train['is_train'] = 0\n","val['is_train'] = 1\n","test['is_train'] = 2\n","data_set = pd.concat([train, val, test])\n","data_set.reset_index(drop=True, inplace=True)\n","data_set.head()"]},{"cell_type":"code","source":["ds_tag = tag_div(data_set)\n","\n","# 키워드의 사용횟수를 통해 불용어 추가(전체의 0.5% 정도로 충분히 적게 사용되는 용어를 불용어로 추가)\n","key_word_cnt = ds_tag['tag'].value_counts()\n","key_word_cnt = pd.DataFrame(key_word_cnt)\n","for i in range(100, 1, -2):\n","  if (key_word_cnt.quantile(i/100)/data_set.shape[0])[0] < 0.005 :\n","    key_word = key_word_cnt.query(f'tag < {(key_word_cnt.quantile(i/100))[0]}')\n","    break\n","stop_words = list(key_word.index)"],"metadata":{"id":"uWs-HKXNym-e","executionInfo":{"status":"ok","timestamp":1677913894378,"user_tz":-540,"elapsed":44745,"user":{"displayName":"JYUN im","userId":"16123544492363400793"}}},"execution_count":4,"outputs":[]},{"cell_type":"code","execution_count":5,"metadata":{"id":"z6CBXj2xfvGg","executionInfo":{"status":"ok","timestamp":1677914734479,"user_tz":-540,"elapsed":831154,"user":{"displayName":"JYUN im","userId":"16123544492363400793"}}},"outputs":[],"source":["for i in range(data_set.shape[0]) :\n","  data_set['tags'][i] = [word for word in data_set['tags'][i] if word not in stop_words]\n","\n","# 노래와 키워드를 개별 값으로 나누어 저장해줌\n","ds = data_set.reset_index()\n","ds_tag = tag_div(ds)\n","ds_song = song_div(ds)\n","ds_like_cnt = ds[['index', 'like_cnt', 'is_train']]\n","\n","# 노래, 키워드, 플레이리스트 좋아요 수를 묶어서 데이터프레임 생성\n","song_tag_data = ds_like_cnt.join(ds_song)\n","song_tag_data = song_tag_data.join(ds_tag)\n","song_tag_data = song_tag_data.reset_index(drop=True).drop(columns='index')\n","song_tag_data.head()\n","\n","# 데이터 분리(train, val, test)\n","song_tag_data_a = song_tag_data.query('is_train == 0')\n","song_tag_data_b = song_tag_data.query('is_train == 1')\n","song_tag_data_c = song_tag_data.query('is_train == 2')"]},{"cell_type":"code","execution_count":6,"metadata":{"id":"5ih8Pn0n_cg0","colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"status":"ok","timestamp":1677914803037,"user_tz":-540,"elapsed":30650,"user":{"displayName":"JYUN im","userId":"16123544492363400793"}},"outputId":"0078fa57-23b7-4ea4-b3d9-bc2655ddf715"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["(588693, 619)"]},"metadata":{},"execution_count":6}],"source":["df_train = song_tag_data_a.pivot_table(index='song', columns='tag', values='like_cnt')\n","df_train = df_train.fillna(0)\n","df_train.shape"]},{"cell_type":"code","execution_count":7,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":2826,"status":"ok","timestamp":1677914990585,"user":{"displayName":"JYUN im","userId":"16123544492363400793"},"user_tz":-540},"id":"giimhw7tAiAJ","outputId":"4b1595ee-a767-4462-e644-d020642f6da0"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["((82075, 615), (49574, 575))"]},"metadata":{},"execution_count":7}],"source":["df_val = song_tag_data_b.pivot_table(index='song', columns='tag', values='like_cnt')\n","df_val = df_val.fillna(0)\n","df_test = song_tag_data_c.pivot_table(index='song', columns='tag', values='like_cnt')\n","df_test = df_test.fillna(0)\n","df_val.shape, df_test.shape"]},{"cell_type":"code","source":["train_column_list = set(df_train.columns)\n","val_column_list = set(df_val.columns)\n","add_columns = list(train_column_list.difference(val_column_list))\n","df_val[add_columns] = None\n","df_val = df_val.fillna(0)\n","df_val.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"KhIJFLFd0J1y","executionInfo":{"status":"ok","timestamp":1677914996261,"user_tz":-540,"elapsed":725,"user":{"displayName":"JYUN im","userId":"16123544492363400793"}},"outputId":"4b4f6498-4553-415a-ac3e-6a3df1eb4a05"},"execution_count":8,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(82075, 619)"]},"metadata":{},"execution_count":8}]},{"cell_type":"code","source":["test_column_list = set(df_test.columns)\n","add_columns = list(train_column_list.difference(test_column_list))\n","df_test[add_columns] = None\n","df_test = df_test.fillna(0)\n","df_test.shape"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"UalaQpB51FPX","executionInfo":{"status":"ok","timestamp":1677914998222,"user_tz":-540,"elapsed":804,"user":{"displayName":"JYUN im","userId":"16123544492363400793"}},"outputId":"6aacffb6-20df-4634-c0e6-d440e799f2db"},"execution_count":9,"outputs":[{"output_type":"execute_result","data":{"text/plain":["(49574, 619)"]},"metadata":{},"execution_count":9}]},{"cell_type":"markdown","metadata":{"id":"G_riDLQ9zWZj"},"source":["## AutoEncoder"]},{"cell_type":"markdown","metadata":{"id":"mCNDsinVzbUa"},"source":["**Denoising AutoEncoder**  \n","\n","사용자의 행동(플레이리스트 좋아요)을 통해 가려진 부분을 예측  \n","\n","  \n","\n","\n","**input data**  \n","특정 키워드 혹은 노래가 가려진 형태의 데이터  \n","**output data**  \n","가려진 키워드 혹은 노래를 예측한 형태의 데이터\n"]},{"cell_type":"code","execution_count":10,"metadata":{"id":"AtnWiZo7L0_R","executionInfo":{"status":"ok","timestamp":1677915006474,"user_tz":-540,"elapsed":804,"user":{"displayName":"JYUN im","userId":"16123544492363400793"}}},"outputs":[],"source":["# df의 값만 따로 저장\n","X_train = df_train.iloc[:, :].values\n","X_val = df_val.iloc[:, :].values\n","X_test = df_test.iloc[:, :].values\n","BATCH_SIZE = 64\n","EPOCHS = 20"]},{"cell_type":"code","source":["X_train_scaled = X_train/X_train.max()\n","X_val_scaled = X_val/X_val.max()\n","X_test_scaled = X_test/X_test.max()"],"metadata":{"id":"rgk96YzrcSR6","executionInfo":{"status":"ok","timestamp":1677915012684,"user_tz":-540,"elapsed":2231,"user":{"displayName":"JYUN im","userId":"16123544492363400793"}}},"execution_count":11,"outputs":[]},{"cell_type":"code","execution_count":12,"metadata":{"id":"p9Co2xQsuGmc","executionInfo":{"status":"ok","timestamp":1677915026325,"user_tz":-540,"elapsed":10183,"user":{"displayName":"JYUN im","userId":"16123544492363400793"}}},"outputs":[],"source":["noise_factor = 0.2\n","X_train_noisy = X_train_scaled + noise_factor * tf.random.normal(shape=X_train.shape)"]},{"cell_type":"code","execution_count":13,"metadata":{"id":"Ul-o-rACD3Az","executionInfo":{"status":"ok","timestamp":1677915030623,"user_tz":-540,"elapsed":298,"user":{"displayName":"JYUN im","userId":"16123544492363400793"}}},"outputs":[],"source":["class AE(tf.keras.models.Model):\n","  def __init__(self, latent_vactor):\n","    self.latent_vactor = latent_vactor\n","    super(AE, self).__init__()\n","    self.encoder = tf.keras.Sequential([\n","        tf.keras.layers.Dense(64, activation='relu'),\n","        tf.keras.layers.Dense(32, activation='relu'),\n","        tf.keras.layers.Dense(16, activation='relu'),\n","        tf.keras.layers.Dense(8, activation='relu'),])\n","    self.decoder = tf.keras.Sequential([\n","        tf.keras.layers.Dense(16, activation='relu'),\n","        tf.keras.layers.Dense(32, activation='relu'),\n","        tf.keras.layers.Dense(64, activation='relu'),\n","        tf.keras.layers.Dense(latent_vactor, activation='sigmoid')\n","    ])\n","  def call(self, X):\n","    encoded = self.encoder(X)\n","    decoded = self.decoder(encoded)\n","    return decoded"]},{"cell_type":"code","execution_count":14,"metadata":{"id":"MRiwK1hU8rvq","executionInfo":{"status":"ok","timestamp":1677915034272,"user_tz":-540,"elapsed":285,"user":{"displayName":"JYUN im","userId":"16123544492363400793"}}},"outputs":[],"source":["model = AE(latent_vactor=X_train.shape[1])\n","model.compile(optimizer='adam', loss='mse', metrics=[tf.keras.metrics.RootMeanSquaredError()])"]},{"cell_type":"code","execution_count":15,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":810828,"status":"ok","timestamp":1677915846542,"user":{"displayName":"JYUN im","userId":"16123544492363400793"},"user_tz":-540},"id":"9swwKI8qH4S-","outputId":"5a9f6631-805c-4ae2-8247-a0198ee9ec27"},"outputs":[{"output_type":"stream","name":"stdout","text":["Epoch 1/20\n","9199/9199 [==============================] - 43s 4ms/step - loss: 8.9447e-04 - root_mean_squared_error: 0.0299 - val_loss: 3.3213e-05 - val_root_mean_squared_error: 0.0058\n","Epoch 2/20\n","9199/9199 [==============================] - 39s 4ms/step - loss: 8.0999e-06 - root_mean_squared_error: 0.0028 - val_loss: 1.2589e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 3/20\n","9199/9199 [==============================] - 41s 4ms/step - loss: 7.4373e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 4/20\n","9199/9199 [==============================] - 39s 4ms/step - loss: 7.2293e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 5/20\n","9199/9199 [==============================] - 40s 4ms/step - loss: 7.3041e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 6/20\n","9199/9199 [==============================] - 39s 4ms/step - loss: 7.3640e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 7/20\n","9199/9199 [==============================] - 40s 4ms/step - loss: 7.3614e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 8/20\n","9199/9199 [==============================] - 39s 4ms/step - loss: 7.3032e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 9/20\n","9199/9199 [==============================] - 43s 5ms/step - loss: 7.3057e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 10/20\n","9199/9199 [==============================] - 40s 4ms/step - loss: 7.3395e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 11/20\n","9199/9199 [==============================] - 42s 5ms/step - loss: 7.2908e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 12/20\n","9199/9199 [==============================] - 40s 4ms/step - loss: 7.2891e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 13/20\n","9199/9199 [==============================] - 41s 4ms/step - loss: 7.3103e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 14/20\n","9199/9199 [==============================] - 38s 4ms/step - loss: 7.2926e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 15/20\n","9199/9199 [==============================] - 39s 4ms/step - loss: 7.3123e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 16/20\n","9199/9199 [==============================] - 40s 4ms/step - loss: 7.3282e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 17/20\n","9199/9199 [==============================] - 41s 4ms/step - loss: 7.3299e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 18/20\n","9199/9199 [==============================] - 39s 4ms/step - loss: 7.3113e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 19/20\n","9199/9199 [==============================] - 44s 5ms/step - loss: 7.3051e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n","Epoch 20/20\n","9199/9199 [==============================] - 38s 4ms/step - loss: 7.2635e-06 - root_mean_squared_error: 0.0027 - val_loss: 1.2591e-05 - val_root_mean_squared_error: 0.0035\n"]},{"output_type":"execute_result","data":{"text/plain":["<keras.callbacks.History at 0x7fab548b4400>"]},"metadata":{},"execution_count":15}],"source":["model.fit(X_train_noisy, X_train_scaled, epochs=EPOCHS, batch_size=BATCH_SIZE, \n","          shuffle=True, validation_data=(X_val_scaled, X_val_scaled))"]},{"cell_type":"markdown","metadata":{"id":"xUsoxb7TgCcm"},"source":["모델 학습 결과"]},{"cell_type":"code","execution_count":16,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":330,"status":"ok","timestamp":1677915852069,"user":{"displayName":"JYUN im","userId":"16123544492363400793"},"user_tz":-540},"id":"fL74h6DyyvsF","outputId":"7e8ab03d-e1a0-430e-edd8-c7873a731580"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[0., 0., 0., ..., 0., 0., 0.],\n","       [0., 0., 0., ..., 0., 0., 0.],\n","       [0., 0., 0., ..., 0., 0., 0.],\n","       ...,\n","       [0., 0., 0., ..., 0., 0., 0.],\n","       [0., 0., 0., ..., 0., 0., 0.],\n","       [0., 0., 0., ..., 0., 0., 0.]])"]},"metadata":{},"execution_count":16}],"source":["X_test_scaled"]},{"cell_type":"code","execution_count":17,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":1110,"status":"ok","timestamp":1677915855467,"user":{"displayName":"JYUN im","userId":"16123544492363400793"},"user_tz":-540},"id":"3EVNEXPlXqPt","outputId":"0d13b6e2-ab20-4836-9e61-faea050c5199"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["array([[1.4709698e-29, 2.5450285e-25, 2.2319092e-28, ..., 1.7598204e-31,\n","        1.5479627e-29, 3.9607585e-35],\n","       [1.4742730e-29, 2.5498874e-25, 2.2366737e-28, ..., 1.7640144e-31,\n","        1.5514387e-29, 3.9712886e-35],\n","       [1.5046012e-29, 2.5945714e-25, 2.2807967e-28, ..., 1.8027908e-31,\n","        1.5833544e-29, 4.0690334e-35],\n","       ...,\n","       [1.4745767e-29, 2.5503444e-25, 2.2371516e-28, ..., 1.7643913e-31,\n","        1.5517583e-29, 3.9722583e-35],\n","       [1.4427608e-29, 2.5036032e-25, 2.1902771e-28, ..., 1.7257297e-31,\n","        1.5185437e-29, 3.8723152e-35],\n","       [1.4754995e-29, 2.5517165e-25, 2.2384747e-28, ..., 1.7655763e-31,\n","        1.5527177e-29, 3.9752596e-35]], dtype=float32)"]},"metadata":{},"execution_count":17}],"source":["encoded = model.encoder(X_test_scaled).numpy()\n","decoded = model.decoder(encoded).numpy()\n","decoded"]},{"cell_type":"code","execution_count":18,"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":470},"executionInfo":{"elapsed":943,"status":"ok","timestamp":1677915859425,"user":{"displayName":"JYUN im","userId":"16123544492363400793"},"user_tz":-540},"id":"eXtJfRBjxUAX","outputId":"fd65fe3c-7233-4558-8ffc-cf1d6199c78c"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["tag            12월       1960_70       1970_80          1980          1990  \\\n","song                                                                         \n","19.0  1.470970e-29  2.545028e-25  2.231909e-28  1.321302e-30  4.227448e-27   \n","30.0  1.474273e-29  2.549887e-25  2.236674e-28  1.324360e-30  4.236068e-27   \n","47.0  1.504601e-29  2.594571e-25  2.280797e-28  1.352615e-30  4.315746e-27   \n","54.0  1.470128e-29  2.543776e-25  2.230658e-28  1.320496e-30  4.225223e-27   \n","59.0  1.467181e-29  2.539423e-25  2.226382e-28  1.317759e-30  4.217477e-27   \n","\n","tag           2000        2000년대          2010        2010년대          2017  \\\n","song                                                                         \n","19.0  3.614229e-36  2.207545e-31  2.668583e-31  8.793193e-28  5.850339e-28   \n","30.0  3.624225e-36  2.212789e-31  2.674882e-31  8.811762e-28  5.862671e-28   \n","47.0  3.716120e-36  2.261206e-31  2.733326e-31  8.981824e-28  5.976501e-28   \n","54.0  3.611693e-36  2.206164e-31  2.666914e-31  8.788533e-28  5.847126e-28   \n","59.0  3.602804e-36  2.201456e-31  2.661264e-31  8.772020e-28  5.836051e-28   \n","\n","tag   ...         JAYJE         얼터너티브            심쿵        1990년대  \\\n","song  ...                                                           \n","19.0  ...  7.283766e-32  1.309182e-35  7.097542e-35  1.691403e-30   \n","30.0  ...  7.301403e-32  1.312703e-35  7.116629e-35  1.695305e-30   \n","47.0  ...  7.463781e-32  1.345495e-35  7.290399e-35  1.731342e-30   \n","54.0  ...  7.279211e-32  1.308264e-35  7.092779e-35  1.690371e-30   \n","59.0  ...  7.263511e-32  1.305094e-35  7.076023e-35  1.686880e-30   \n","\n","tag           남자보컬        취향저격DJ  서정적인            트랩           자기전  \\\n","song                                                                 \n","19.0  2.454227e-30  2.913841e-32   0.0  1.759820e-31  1.547963e-29   \n","30.0  2.459870e-30  2.920986e-32   0.0  1.764014e-31  1.551439e-29   \n","47.0  2.511891e-30  2.986812e-32   0.0  1.802791e-31  1.583354e-29   \n","54.0  2.452748e-30  2.911997e-32   0.0  1.758706e-31  1.547077e-29   \n","59.0  2.447720e-30  2.905605e-32   0.0  1.754953e-31  1.543976e-29   \n","\n","tag             외출  \n","song                \n","19.0  3.960758e-35  \n","30.0  3.971289e-35  \n","47.0  4.069033e-35  \n","54.0  3.958010e-35  \n","59.0  3.948539e-35  \n","\n","[5 rows x 619 columns]"],"text/html":["\n","  <div id=\"df-8f846bcf-0981-4dcc-ab88-2aae8dfb916e\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th>tag</th>\n","      <th>12월</th>\n","      <th>1960_70</th>\n","      <th>1970_80</th>\n","      <th>1980</th>\n","      <th>1990</th>\n","      <th>2000</th>\n","      <th>2000년대</th>\n","      <th>2010</th>\n","      <th>2010년대</th>\n","      <th>2017</th>\n","      <th>...</th>\n","      <th>JAYJE</th>\n","      <th>얼터너티브</th>\n","      <th>심쿵</th>\n","      <th>1990년대</th>\n","      <th>남자보컬</th>\n","      <th>취향저격DJ</th>\n","      <th>서정적인</th>\n","      <th>트랩</th>\n","      <th>자기전</th>\n","      <th>외출</th>\n","    </tr>\n","    <tr>\n","      <th>song</th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","      <th></th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>19.0</th>\n","      <td>1.470970e-29</td>\n","      <td>2.545028e-25</td>\n","      <td>2.231909e-28</td>\n","      <td>1.321302e-30</td>\n","      <td>4.227448e-27</td>\n","      <td>3.614229e-36</td>\n","      <td>2.207545e-31</td>\n","      <td>2.668583e-31</td>\n","      <td>8.793193e-28</td>\n","      <td>5.850339e-28</td>\n","      <td>...</td>\n","      <td>7.283766e-32</td>\n","      <td>1.309182e-35</td>\n","      <td>7.097542e-35</td>\n","      <td>1.691403e-30</td>\n","      <td>2.454227e-30</td>\n","      <td>2.913841e-32</td>\n","      <td>0.0</td>\n","      <td>1.759820e-31</td>\n","      <td>1.547963e-29</td>\n","      <td>3.960758e-35</td>\n","    </tr>\n","    <tr>\n","      <th>30.0</th>\n","      <td>1.474273e-29</td>\n","      <td>2.549887e-25</td>\n","      <td>2.236674e-28</td>\n","      <td>1.324360e-30</td>\n","      <td>4.236068e-27</td>\n","      <td>3.624225e-36</td>\n","      <td>2.212789e-31</td>\n","      <td>2.674882e-31</td>\n","      <td>8.811762e-28</td>\n","      <td>5.862671e-28</td>\n","      <td>...</td>\n","      <td>7.301403e-32</td>\n","      <td>1.312703e-35</td>\n","      <td>7.116629e-35</td>\n","      <td>1.695305e-30</td>\n","      <td>2.459870e-30</td>\n","      <td>2.920986e-32</td>\n","      <td>0.0</td>\n","      <td>1.764014e-31</td>\n","      <td>1.551439e-29</td>\n","      <td>3.971289e-35</td>\n","    </tr>\n","    <tr>\n","      <th>47.0</th>\n","      <td>1.504601e-29</td>\n","      <td>2.594571e-25</td>\n","      <td>2.280797e-28</td>\n","      <td>1.352615e-30</td>\n","      <td>4.315746e-27</td>\n","      <td>3.716120e-36</td>\n","      <td>2.261206e-31</td>\n","      <td>2.733326e-31</td>\n","      <td>8.981824e-28</td>\n","      <td>5.976501e-28</td>\n","      <td>...</td>\n","      <td>7.463781e-32</td>\n","      <td>1.345495e-35</td>\n","      <td>7.290399e-35</td>\n","      <td>1.731342e-30</td>\n","      <td>2.511891e-30</td>\n","      <td>2.986812e-32</td>\n","      <td>0.0</td>\n","      <td>1.802791e-31</td>\n","      <td>1.583354e-29</td>\n","      <td>4.069033e-35</td>\n","    </tr>\n","    <tr>\n","      <th>54.0</th>\n","      <td>1.470128e-29</td>\n","      <td>2.543776e-25</td>\n","      <td>2.230658e-28</td>\n","      <td>1.320496e-30</td>\n","      <td>4.225223e-27</td>\n","      <td>3.611693e-36</td>\n","      <td>2.206164e-31</td>\n","      <td>2.666914e-31</td>\n","      <td>8.788533e-28</td>\n","      <td>5.847126e-28</td>\n","      <td>...</td>\n","      <td>7.279211e-32</td>\n","      <td>1.308264e-35</td>\n","      <td>7.092779e-35</td>\n","      <td>1.690371e-30</td>\n","      <td>2.452748e-30</td>\n","      <td>2.911997e-32</td>\n","      <td>0.0</td>\n","      <td>1.758706e-31</td>\n","      <td>1.547077e-29</td>\n","      <td>3.958010e-35</td>\n","    </tr>\n","    <tr>\n","      <th>59.0</th>\n","      <td>1.467181e-29</td>\n","      <td>2.539423e-25</td>\n","      <td>2.226382e-28</td>\n","      <td>1.317759e-30</td>\n","      <td>4.217477e-27</td>\n","      <td>3.602804e-36</td>\n","      <td>2.201456e-31</td>\n","      <td>2.661264e-31</td>\n","      <td>8.772020e-28</td>\n","      <td>5.836051e-28</td>\n","      <td>...</td>\n","      <td>7.263511e-32</td>\n","      <td>1.305094e-35</td>\n","      <td>7.076023e-35</td>\n","      <td>1.686880e-30</td>\n","      <td>2.447720e-30</td>\n","      <td>2.905605e-32</td>\n","      <td>0.0</td>\n","      <td>1.754953e-31</td>\n","      <td>1.543976e-29</td>\n","      <td>3.948539e-35</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>5 rows × 619 columns</p>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-8f846bcf-0981-4dcc-ab88-2aae8dfb916e')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-8f846bcf-0981-4dcc-ab88-2aae8dfb916e button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-8f846bcf-0981-4dcc-ab88-2aae8dfb916e');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":18}],"source":["result = pd.DataFrame(data = decoded, index = df_test.index, columns = df_test.columns).fillna(0)\n","result.head()"]},{"cell_type":"markdown","metadata":{"id":"7NWWCMLVzhFB"},"source":["**가장 많이 사용된 단어 찾기**"]},{"cell_type":"code","execution_count":19,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":311,"status":"ok","timestamp":1677915864153,"user":{"displayName":"JYUN im","userId":"16123544492363400793"},"user_tz":-540},"id":"_QkWBEXWzk9M","outputId":"765546f6-6ec2-45e6-a9dc-ba20e341161f"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["기분전환    850773\n","감성      602488\n","드라이브    573589\n","발라드     562551\n","휴식      531293\n","Name: tag, dtype: int64"]},"metadata":{},"execution_count":19}],"source":["key_word_count = song_tag_data['tag'].value_counts()\n","key_word_count = key_word_count.sort_values(ascending=False)\n","key_word_count.head()"]},{"cell_type":"markdown","metadata":{"id":"rsX9e4ggz7RY"},"source":["**기분전환**이라는 키워드를 검색했을 때, 나오는 결과"]},{"cell_type":"code","execution_count":37,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":4,"status":"ok","timestamp":1677916406664,"user":{"displayName":"JYUN im","userId":"16123544492363400793"},"user_tz":-540},"id":"Pj9LCenqxsAz","outputId":"e19eab89-b6fc-4b9d-bc6a-b00225f9d97d"},"outputs":[{"output_type":"execute_result","data":{"text/plain":["song\n","613616.0    7.350664e-27\n","620970.0    6.993374e-27\n","462581.0    5.436626e-27\n","487591.0    5.436626e-27\n","707178.0    5.436626e-27\n","478998.0    5.436626e-27\n","494290.0    5.436626e-27\n","365864.0    5.436626e-27\n","650142.0    5.436626e-27\n","72214.0     5.436626e-27\n","671254.0    5.436626e-27\n","40860.0     5.436626e-27\n","528281.0    5.436626e-27\n","317795.0    5.436626e-27\n","43418.0     5.436626e-27\n","Name: 기분전환, dtype: float32"]},"metadata":{},"execution_count":37}],"source":["plyst_keyword = result['기분전환']\n","plyst_keyword = plyst_keyword.sort_values(ascending=False)\n","plyst_keyword.head(15)"]},{"cell_type":"code","source":["dk = pd.DataFrame(plyst_keyword).reset_index()\n","value = [v for v in dk[:10]['song']]\n","drive_keyword_result = song_meta.query(f'id in {value}')\n","drive_keyword_result"],"metadata":{"colab":{"base_uri":"https://localhost:8080/","height":476},"id":"wA1dLDqQlJRQ","executionInfo":{"status":"ok","timestamp":1677916438460,"user_tz":-540,"elapsed":286,"user":{"displayName":"JYUN im","userId":"16123544492363400793"}},"outputId":"eb107525-be01-44ea-b731-b759499d206d"},"execution_count":38,"outputs":[{"output_type":"execute_result","data":{"text/plain":["          song_gn_dtl_gnr_basket issue_date                     album_name  \\\n","72214   [GN1304, GN1301, GN1302]   20170407                        Roll Up   \n","365864          [GN1301, GN1302]   20170303                       The Deep   \n","462581  [GN1304, GN1301, GN1302]   20170609  Blue Eyes (Feat. Matty Owens)   \n","478998                  [GN0901]   20170721                Sex 4 Breakfast   \n","487591  [GN1304, GN1301, GN1302]   20170719                      God Knows   \n","494290          [GN1301, GN1302]   20170420      The Boy Who Cried Freedom   \n","613616                  [GN0901]   20170929   Tell Me You Love Me (Deluxe)   \n","620970          [GN1301, GN1302]   20180330                      Push Back   \n","650142          [GN1301, GN1302]   20170714                 Temporary Love   \n","707178          [GN1304, GN1301]   20170428            Walking On The Moon   \n","\n","        album_id artist_id_basket                      song_name  \\\n","72214   10052218         [858532]                        Roll Up   \n","365864  10042839         [709491]     The Deep (Feat. Joey Purp)   \n","462581  10069242        [1758903]  Blue Eyes (Feat. Matty Owens)   \n","478998  10081006         [905364]                Sex 4 Breakfast   \n","487591  10080587         [857550]                      God Knows   \n","494290  10058033         [785078]                   Chainsmoking   \n","613616  10078724         [261830]                Sorry Not Sorry   \n","620970  10066653         [181769]              Another Love Song   \n","650142  10083648        [1865623]                 Temporary Love   \n","707178  10062651        [1704704]            Walking On The Moon   \n","\n","       song_gn_gnr_basket artist_name_basket      id  \n","72214            [GN1300]     [Johnny Yukon]   72214  \n","365864           [GN1300]          [ZZ Ward]  365864  \n","462581           [GN1300]    [Miranda Glory]  462581  \n","478998           [GN0900]         [KStewart]  478998  \n","487591           [GN1300]           [Dornik]  487591  \n","494290           [GN1300]      [Jacob Banks]  494290  \n","613616           [GN0900]      [Demi Lovato]  613616  \n","620970           [GN1300]            [Ne-Yo]  620970  \n","650142           [GN1300]             [Joey]  650142  \n","707178           [GN1300]            [Quest]  707178  "],"text/html":["\n","  <div id=\"df-59cd0985-81e4-4393-9368-714a8449e5a5\">\n","    <div class=\"colab-df-container\">\n","      <div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>song_gn_dtl_gnr_basket</th>\n","      <th>issue_date</th>\n","      <th>album_name</th>\n","      <th>album_id</th>\n","      <th>artist_id_basket</th>\n","      <th>song_name</th>\n","      <th>song_gn_gnr_basket</th>\n","      <th>artist_name_basket</th>\n","      <th>id</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>72214</th>\n","      <td>[GN1304, GN1301, GN1302]</td>\n","      <td>20170407</td>\n","      <td>Roll Up</td>\n","      <td>10052218</td>\n","      <td>[858532]</td>\n","      <td>Roll Up</td>\n","      <td>[GN1300]</td>\n","      <td>[Johnny Yukon]</td>\n","      <td>72214</td>\n","    </tr>\n","    <tr>\n","      <th>365864</th>\n","      <td>[GN1301, GN1302]</td>\n","      <td>20170303</td>\n","      <td>The Deep</td>\n","      <td>10042839</td>\n","      <td>[709491]</td>\n","      <td>The Deep (Feat. Joey Purp)</td>\n","      <td>[GN1300]</td>\n","      <td>[ZZ Ward]</td>\n","      <td>365864</td>\n","    </tr>\n","    <tr>\n","      <th>462581</th>\n","      <td>[GN1304, GN1301, GN1302]</td>\n","      <td>20170609</td>\n","      <td>Blue Eyes (Feat. Matty Owens)</td>\n","      <td>10069242</td>\n","      <td>[1758903]</td>\n","      <td>Blue Eyes (Feat. Matty Owens)</td>\n","      <td>[GN1300]</td>\n","      <td>[Miranda Glory]</td>\n","      <td>462581</td>\n","    </tr>\n","    <tr>\n","      <th>478998</th>\n","      <td>[GN0901]</td>\n","      <td>20170721</td>\n","      <td>Sex 4 Breakfast</td>\n","      <td>10081006</td>\n","      <td>[905364]</td>\n","      <td>Sex 4 Breakfast</td>\n","      <td>[GN0900]</td>\n","      <td>[KStewart]</td>\n","      <td>478998</td>\n","    </tr>\n","    <tr>\n","      <th>487591</th>\n","      <td>[GN1304, GN1301, GN1302]</td>\n","      <td>20170719</td>\n","      <td>God Knows</td>\n","      <td>10080587</td>\n","      <td>[857550]</td>\n","      <td>God Knows</td>\n","      <td>[GN1300]</td>\n","      <td>[Dornik]</td>\n","      <td>487591</td>\n","    </tr>\n","    <tr>\n","      <th>494290</th>\n","      <td>[GN1301, GN1302]</td>\n","      <td>20170420</td>\n","      <td>The Boy Who Cried Freedom</td>\n","      <td>10058033</td>\n","      <td>[785078]</td>\n","      <td>Chainsmoking</td>\n","      <td>[GN1300]</td>\n","      <td>[Jacob Banks]</td>\n","      <td>494290</td>\n","    </tr>\n","    <tr>\n","      <th>613616</th>\n","      <td>[GN0901]</td>\n","      <td>20170929</td>\n","      <td>Tell Me You Love Me (Deluxe)</td>\n","      <td>10078724</td>\n","      <td>[261830]</td>\n","      <td>Sorry Not Sorry</td>\n","      <td>[GN0900]</td>\n","      <td>[Demi Lovato]</td>\n","      <td>613616</td>\n","    </tr>\n","    <tr>\n","      <th>620970</th>\n","      <td>[GN1301, GN1302]</td>\n","      <td>20180330</td>\n","      <td>Push Back</td>\n","      <td>10066653</td>\n","      <td>[181769]</td>\n","      <td>Another Love Song</td>\n","      <td>[GN1300]</td>\n","      <td>[Ne-Yo]</td>\n","      <td>620970</td>\n","    </tr>\n","    <tr>\n","      <th>650142</th>\n","      <td>[GN1301, GN1302]</td>\n","      <td>20170714</td>\n","      <td>Temporary Love</td>\n","      <td>10083648</td>\n","      <td>[1865623]</td>\n","      <td>Temporary Love</td>\n","      <td>[GN1300]</td>\n","      <td>[Joey]</td>\n","      <td>650142</td>\n","    </tr>\n","    <tr>\n","      <th>707178</th>\n","      <td>[GN1304, GN1301]</td>\n","      <td>20170428</td>\n","      <td>Walking On The Moon</td>\n","      <td>10062651</td>\n","      <td>[1704704]</td>\n","      <td>Walking On The Moon</td>\n","      <td>[GN1300]</td>\n","      <td>[Quest]</td>\n","      <td>707178</td>\n","    </tr>\n","  </tbody>\n","</table>\n","</div>\n","      <button class=\"colab-df-convert\" onclick=\"convertToInteractive('df-59cd0985-81e4-4393-9368-714a8449e5a5')\"\n","              title=\"Convert this dataframe to an interactive table.\"\n","              style=\"display:none;\">\n","        \n","  <svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\"viewBox=\"0 0 24 24\"\n","       width=\"24px\">\n","    <path d=\"M0 0h24v24H0V0z\" fill=\"none\"/>\n","    <path d=\"M18.56 5.44l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94zm-11 1L8.5 8.5l.94-2.06 2.06-.94-2.06-.94L8.5 2.5l-.94 2.06-2.06.94zm10 10l.94 2.06.94-2.06 2.06-.94-2.06-.94-.94-2.06-.94 2.06-2.06.94z\"/><path d=\"M17.41 7.96l-1.37-1.37c-.4-.4-.92-.59-1.43-.59-.52 0-1.04.2-1.43.59L10.3 9.45l-7.72 7.72c-.78.78-.78 2.05 0 2.83L4 21.41c.39.39.9.59 1.41.59.51 0 1.02-.2 1.41-.59l7.78-7.78 2.81-2.81c.8-.78.8-2.07 0-2.86zM5.41 20L4 18.59l7.72-7.72 1.47 1.35L5.41 20z\"/>\n","  </svg>\n","      </button>\n","      \n","  <style>\n","    .colab-df-container {\n","      display:flex;\n","      flex-wrap:wrap;\n","      gap: 12px;\n","    }\n","\n","    .colab-df-convert {\n","      background-color: #E8F0FE;\n","      border: none;\n","      border-radius: 50%;\n","      cursor: pointer;\n","      display: none;\n","      fill: #1967D2;\n","      height: 32px;\n","      padding: 0 0 0 0;\n","      width: 32px;\n","    }\n","\n","    .colab-df-convert:hover {\n","      background-color: #E2EBFA;\n","      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);\n","      fill: #174EA6;\n","    }\n","\n","    [theme=dark] .colab-df-convert {\n","      background-color: #3B4455;\n","      fill: #D2E3FC;\n","    }\n","\n","    [theme=dark] .colab-df-convert:hover {\n","      background-color: #434B5C;\n","      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);\n","      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));\n","      fill: #FFFFFF;\n","    }\n","  </style>\n","\n","      <script>\n","        const buttonEl =\n","          document.querySelector('#df-59cd0985-81e4-4393-9368-714a8449e5a5 button.colab-df-convert');\n","        buttonEl.style.display =\n","          google.colab.kernel.accessAllowed ? 'block' : 'none';\n","\n","        async function convertToInteractive(key) {\n","          const element = document.querySelector('#df-59cd0985-81e4-4393-9368-714a8449e5a5');\n","          const dataTable =\n","            await google.colab.kernel.invokeFunction('convertToInteractive',\n","                                                     [key], {});\n","          if (!dataTable) return;\n","\n","          const docLinkHtml = 'Like what you see? Visit the ' +\n","            '<a target=\"_blank\" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'\n","            + ' to learn more about interactive tables.';\n","          element.innerHTML = '';\n","          dataTable['output_type'] = 'display_data';\n","          await google.colab.output.renderOutput(dataTable, element);\n","          const docLink = document.createElement('div');\n","          docLink.innerHTML = docLinkHtml;\n","          element.appendChild(docLink);\n","        }\n","      </script>\n","    </div>\n","  </div>\n","  "]},"metadata":{},"execution_count":38}]}],"metadata":{"colab":{"machine_shape":"hm","provenance":[{"file_id":"1tUGGwz6-tHOZF06b1vARobwVSXQ1eaf3","timestamp":1675574207361}],"mount_file_id":"1DeXok7iTLyJpubqRwRLtxRdlUSUqwC83","authorship_tag":"ABX9TyN7y85oY0AFlmCgU7l+Zph7"},"gpuClass":"standard","kernelspec":{"display_name":"Python 3","name":"python3"},"language_info":{"name":"python"}},"nbformat":4,"nbformat_minor":0}